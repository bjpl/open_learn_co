# ============================================================================
# BACKEND ENVIRONMENT CONFIGURATION
# Colombia Intelligence & Language Learning Platform
# ============================================================================

# ----------------------------------------------------------------------------
# APPLICATION SETTINGS
# ----------------------------------------------------------------------------
# Application name displayed in logs and UI
# Type: string
# Required: No
# Default: "Colombia Intel Platform"
APP_NAME="Colombia Intel Platform"

# Enable debug mode (detailed error messages, auto-reload)
# Type: boolean
# Required: No
# Default: False
# WARNING: MUST be False in production!
DEBUG=False

# Deployment environment
# Type: string
# Required: Yes
# Options: development, staging, production
# Default: development
ENVIRONMENT=development

# ----------------------------------------------------------------------------
# SECURITY CONFIGURATION
# ----------------------------------------------------------------------------
# Secret key for JWT token signing and encryption
# Type: string (minimum 32 bytes URL-safe base64)
# Required: Yes (CRITICAL in production)
# Generate with: python backend/scripts/generate_secret_key.py
# Quick generate: python -c "import secrets; print(secrets.token_urlsafe(64))"
#
# PRODUCTION SECURITY REQUIREMENTS:
# 1. Generate a NEW key for each environment (dev/staging/prod)
# 2. NEVER commit the actual key to version control
# 3. Store in environment variables or secure vaults (AWS Secrets Manager, etc)
# 4. Rotate keys periodically (recommended: every 90 days)
# 5. Minimum size: 32 bytes (64 recommended for production)
#
# WARNING: Using the default key is a CRITICAL SECURITY VULNERABILITY!
SECRET_KEY=REPLACE_THIS_IN_PRODUCTION_USE_generate_secret_key_script

# JWT access token expiration time in minutes
# Type: integer
# Required: No
# Default: 30
# Recommended: 15-60 minutes for production
ACCESS_TOKEN_EXPIRE_MINUTES=30

# JWT refresh token expiration time in days
# Type: integer
# Required: No
# Default: 7
# Recommended: 7-30 days for production
REFRESH_TOKEN_EXPIRE_DAYS=7

# JWT algorithm for token signing
# Type: string
# Required: No
# Default: HS256
# Options: HS256, HS384, HS512 (symmetric) or RS256, RS384, RS512 (asymmetric)
ALGORITHM=HS256

# ----------------------------------------------------------------------------
# DATABASE CONFIGURATION
# ----------------------------------------------------------------------------
# PostgreSQL database connection URL
# Type: url
# Required: Yes (CRITICAL)
# Format: postgresql://username:password@host:port/database
# Example: postgresql://user:pass@localhost:5432/colombia_intel
DATABASE_URL=postgresql://colombian_user:colombian_pass@localhost:5432/colombian_platform

# Database Connection Pool Configuration
# These settings control how many database connections are maintained
# and how they are managed for optimal performance and resource utilization

# Pool size - number of connections to keep open
# Type: integer
# Required: No
# Default: 20 (production), 5 (development)
# Recommended: Set based on max concurrent users * 2
# Production range: 20-50 for high traffic
DB_POOL_SIZE=20

# Max overflow - additional connections beyond pool_size
# Type: integer
# Required: No
# Default: 10
# Recommended: 50% of pool_size
# These are temporary connections created under high load
DB_MAX_OVERFLOW=10

# Pool timeout - seconds to wait for available connection
# Type: integer
# Required: No
# Default: 30
# Recommended: 30-60 seconds
# Lower values fail faster, higher values are more patient
DB_POOL_TIMEOUT=30

# Pool recycle - seconds before recycling connections
# Type: integer
# Required: No
# Default: 3600 (production), 1800 (development)
# Recommended: 3600 (1 hour) to prevent stale connections
# Prevents database connection timeouts
DB_POOL_RECYCLE=3600

# Pool pre-ping - verify connection health before use
# Type: boolean
# Required: No
# Default: true
# Recommended: true for production (adds small overhead but prevents errors)
# Ensures connections are valid before use
DB_POOL_PRE_PING=true

# Connection timeout - seconds to wait for initial connection
# Type: integer
# Required: No
# Default: 10
# Recommended: 10-30 seconds
# How long to wait when establishing new connection
DB_CONNECT_TIMEOUT=10

# Command timeout - seconds for query execution
# Type: integer
# Required: No
# Default: 60
# Recommended: 60-300 seconds depending on query complexity
# Prevents long-running queries from blocking pool
DB_COMMAND_TIMEOUT=60

# ----------------------------------------------------------------------------
# CACHE & SESSION STORAGE
# ----------------------------------------------------------------------------
# Redis connection URL for caching and session storage
# Type: url
# Required: Yes
# Format: redis://[:password@]host:port[/db]
# Example: redis://:mypassword@localhost:6379/0
REDIS_URL=redis://:redis_pass@localhost:6379/0

# ----------------------------------------------------------------------------
# RATE LIMITING CONFIGURATION
# ----------------------------------------------------------------------------
# Enable/disable API rate limiting
# Type: boolean
# Required: No
# Default: True
RATE_LIMIT_ENABLED=True

# Rate limiting strategy
# Type: string
# Required: No
# Default: sliding_window
# Options: sliding_window, fixed_window
RATE_LIMIT_STRATEGY=sliding_window

# Anonymous user rate limits (requests per minute)
# Type: integer
# Required: No
# Default: 60
RATE_LIMIT_ANONYMOUS_PER_MINUTE=60

# Anonymous user rate limits (requests per hour)
# Type: integer
# Required: No
# Default: 1000
RATE_LIMIT_ANONYMOUS_PER_HOUR=1000

# Authenticated user rate limits (requests per minute)
# Type: integer
# Required: No
# Default: 300
RATE_LIMIT_AUTHENTICATED_PER_MINUTE=300

# Authenticated user rate limits (requests per hour)
# Type: integer
# Required: No
# Default: 5000
RATE_LIMIT_AUTHENTICATED_PER_HOUR=5000

# Heavy endpoint rate limits (requests per minute)
# Type: integer
# Required: No
# Default: 10
# Note: Applies to /api/scraping and /api/analysis endpoints
RATE_LIMIT_HEAVY_PER_MINUTE=10

# Heavy endpoint rate limits (requests per hour)
# Type: integer
# Required: No
# Default: 100
RATE_LIMIT_HEAVY_PER_HOUR=100

# Rate limiter fail-open behavior
# Type: boolean
# Required: No
# Default: True
# If True, allows requests when Redis is unavailable
# If False, rejects requests when Redis is unavailable
RATE_LIMIT_FAIL_OPEN=True

# ----------------------------------------------------------------------------
# SEARCH ENGINE
# ----------------------------------------------------------------------------
# Elasticsearch connection URL for full-text search
# Type: url
# Required: Yes
# Format: http://host:port
ELASTICSEARCH_URL=http://localhost:9200

# Elasticsearch index name for content storage
# Type: string
# Required: No
# Default: colombia_content
ELASTICSEARCH_INDEX=colombia_content

# ----------------------------------------------------------------------------
# CORS CONFIGURATION
# ----------------------------------------------------------------------------
# Allowed origins for CORS (comma-separated)
# Type: string (comma-separated URLs)
# Required: Yes
# Example: http://localhost:3000,https://yourdomain.com
# IMPORTANT: Pydantic uses validation_alias="ALLOWED_ORIGINS" in settings.py
# So you MUST set ALLOWED_ORIGINS (not CORS_ORIGINS) in your .env file
ALLOWED_ORIGINS=http://localhost:3000,http://localhost:3001,http://localhost:3006,http://localhost:8000
CORS_ORIGINS=http://localhost:3000,http://localhost:3001,http://localhost:3006,http://localhost:8000

# ----------------------------------------------------------------------------
# COLOMBIAN DATA SOURCES - API KEYS
# ----------------------------------------------------------------------------
# DANE (Departamento Administrativo Nacional de Estadística) API Key
# Type: string
# Required: Optional (for advanced statistics)
# URL: https://www.dane.gov.co/
DANE_API_KEY=

# Banco de la República API Base URL
# Type: url
# Required: No
# Default: https://www.banrep.gov.co/api
BANREP_BASE_URL=https://www.banrep.gov.co/api

# SECOP (Sistema Electrónico de Contratación Pública) API Token
# Type: string
# Required: Optional (for procurement data)
# URL: https://www.colombiacompra.gov.co/
SECOP_API_TOKEN=

# Datos.gov.co Open Data Portal Base URL
# Type: url
# Required: No
# Default: https://www.datos.gov.co/api
DATOS_GOV_BASE_URL=https://www.datos.gov.co/api

# IDEAM (Instituto de Hidrología, Meteorología y Estudios Ambientales) API Key
# Type: string
# Required: Optional (for environmental data)
# URL: http://www.ideam.gov.co/
IDEAM_API_KEY=

# Departamento Nacional de Planeación (DNP) API Key
# Type: string
# Required: Optional (for planning data)
DNP_API_KEY=

# Ministerio de Hacienda API Key
# Type: string
# Required: Optional (for financial data)
MINHACIENDA_API_KEY=

# ----------------------------------------------------------------------------
# WEB SCRAPING CONFIGURATION
# ----------------------------------------------------------------------------
# Enable/disable scheduled scraping jobs
# Type: boolean
# Required: No
# Default: True
ENABLE_SCHEDULER=True

# Interval between scraping runs (minutes)
# Type: integer
# Required: No
# Default: 30
SCRAPING_INTERVAL_MINUTES=30

# Maximum number of concurrent scrapers
# Type: integer
# Required: No
# Default: 5
# Range: 1-20 (higher values may trigger rate limiting)
MAX_CONCURRENT_SCRAPERS=5

# HTTP request timeout for scrapers (seconds)
# Type: integer
# Required: No
# Default: 30
REQUEST_TIMEOUT=30

# Scraper rate limit (requests per second)
# Type: integer
# Required: No
# Default: 5
# WARNING: Respect target websites' rate limits
SCRAPER_RATE_LIMIT=5

# Scraper timeout (seconds)
# Type: integer
# Required: No
# Default: 30
SCRAPER_TIMEOUT=30

# Enable user agent rotation to avoid blocking
# Type: boolean
# Required: No
# Default: True
USER_AGENT_ROTATION=True

# ----------------------------------------------------------------------------
# NATURAL LANGUAGE PROCESSING (NLP)
# ----------------------------------------------------------------------------
# SpaCy language model for Spanish
# Type: string
# Required: No
# Default: es_core_news_lg
# Options: es_core_news_sm, es_core_news_md, es_core_news_lg
# Note: Download with: python -m spacy download es_core_news_lg
SPACY_MODEL=es_core_news_lg

# Alternative Spanish NLP model name
# Type: string
# Required: No
# Default: es_core_news_sm
SPANISH_NLP_MODEL=es_core_news_sm

# Minimum confidence threshold for entity extraction
# Type: float
# Required: No
# Default: 0.7
# Range: 0.0-1.0
MIN_ENTITY_CONFIDENCE=0.7

# Enable entity extraction during content processing
# Type: boolean
# Required: No
# Default: True
ENABLE_ENTITY_EXTRACTION=True

# Enable difficulty scoring for language learning
# Type: boolean
# Required: No
# Default: True
ENABLE_DIFFICULTY_SCORING=True

# ----------------------------------------------------------------------------
# LANGUAGE LEARNING CONFIGURATION
# ----------------------------------------------------------------------------
# Minimum word frequency to include in vocabulary
# Type: integer
# Required: No
# Default: 3
MIN_WORD_FREQUENCY=3

# Vocabulary batch size for learning sessions
# Type: integer
# Required: No
# Default: 20
VOCABULARY_BATCH_SIZE=20

# ----------------------------------------------------------------------------
# TASK QUEUE (CELERY)
# ----------------------------------------------------------------------------
# Celery broker URL for task queue
# Type: url
# Required: Yes (if using background workers)
# Format: redis://[:password@]host:port/db
CELERY_BROKER_URL=redis://:redis_pass@localhost:6379/1

# Celery result backend URL
# Type: url
# Required: Yes (if using background workers)
# Format: redis://[:password@]host:port/db
CELERY_RESULT_BACKEND=redis://:redis_pass@localhost:6379/1

# ----------------------------------------------------------------------------
# LOGGING & MONITORING
# ----------------------------------------------------------------------------
# Log level for application logging
# Type: string
# Required: No
# Default: INFO
# Options: DEBUG, INFO, WARNING, ERROR, CRITICAL
LOG_LEVEL=INFO

# Log directory for file-based logging
# Type: path
# Required: No
# Default: logs
LOG_DIR=logs

# Enable console logging output
# Type: boolean
# Required: No
# Default: True
LOG_ENABLE_CONSOLE=True

# Enable file-based logging
# Type: boolean
# Required: No
# Default: True
LOG_ENABLE_FILE=True

# Maximum log file size before rotation (bytes)
# Type: integer
# Required: No
# Default: 10485760 (10MB)
LOG_MAX_BYTES=10485760

# Number of backup log files to keep
# Type: integer
# Required: No
# Default: 5
LOG_BACKUP_COUNT=5

# Log output format
# Type: string
# Required: No
# Default: json
# Options: json, text
LOG_FORMAT=json

# Enable Prometheus metrics collection
# Type: boolean
# Required: No
# Default: True
METRICS_ENABLED=True

# Prometheus metrics port
# Type: integer
# Required: No
# Default: 9090
METRICS_PORT=9090

# Health check interval (seconds)
# Type: integer
# Required: No
# Default: 30
HEALTH_CHECK_INTERVAL=30

# Slow request threshold in milliseconds
# Type: float
# Required: No
# Default: 1000.0
SLOW_REQUEST_THRESHOLD_MS=1000.0

# Enable detailed performance logging
# Type: boolean
# Required: No
# Default: True
ENABLE_PERFORMANCE_LOGGING=True

# Sentry DSN for error tracking (optional)
# Type: url
# Required: No
SENTRY_DSN=

# Sentry environment tag
# Type: string
# Required: No
# Default: development
SENTRY_ENVIRONMENT=development

# Sentry traces sample rate (0.0-1.0)
# Type: float
# Required: No
# Default: 1.0
SENTRY_TRACES_SAMPLE_RATE=1.0

# ----------------------------------------------------------------------------
# ALERTING CONFIGURATION
# ----------------------------------------------------------------------------
# Email alerting - SMTP host
# Type: string
# Required: No (required for email alerts)
SMTP_HOST=

# Email alerting - SMTP port
# Type: integer
# Required: No
# Default: 587
SMTP_PORT=587

# Email alerting - SMTP username
# Type: string
# Required: No (required for email alerts)
SMTP_USER=

# Email alerting - SMTP password
# Type: string
# Required: No (required for email alerts)
SMTP_PASSWORD=

# Email alerting - From address
# Type: string
# Required: No (required for email alerts)
ALERT_EMAIL_FROM=

# Email alerting - To addresses (comma-separated)
# Type: string
# Required: No
ALERT_EMAIL_TO=

# Slack webhook URL for alerts
# Type: url
# Required: No (required for Slack alerts)
SLACK_WEBHOOK_URL=

# Slack channel for alerts
# Type: string
# Required: No
# Default: #alerts
SLACK_CHANNEL=#alerts

# ----------------------------------------------------------------------------
# COMPRESSION CONFIGURATION
# ----------------------------------------------------------------------------
# Enable response compression (brotli/gzip)
# Type: boolean
# Required: No
# Default: True
# Improves bandwidth usage and response times
ENABLE_COMPRESSION=True

# Brotli compression level (1-11)
# Type: integer
# Required: No
# Default: 4 (balanced)
# Range: 1 (fastest) to 11 (best compression)
# Production recommended: 4-6
BROTLI_COMPRESSION_LEVEL=4

# Gzip compression level (1-9)
# Type: integer
# Required: No
# Default: 6 (balanced)
# Range: 1 (fastest) to 9 (best compression)
# Production recommended: 6
GZIP_COMPRESSION_LEVEL=6

# Minimum response size for compression (bytes)
# Type: integer
# Required: No
# Default: 500
# Responses smaller than this won't be compressed (overhead not worth it)
COMPRESSION_MIN_SIZE=500

# ----------------------------------------------------------------------------
# PYTHON CONFIGURATION
# ----------------------------------------------------------------------------
# Python path for imports
# Type: path
# Required: Yes (for Docker/production)
# Default: /app
PYTHONPATH=/app
